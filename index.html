<!DOCTYPE html>
<html>
<head>
  <title>ESP Control</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/mqttws31.min.js"></script>
</head>
<body>
  <h2>ESP Control Panel</h2>
  
  <!-- Relay buttons -->
  <button onclick="sendCommand('ON')">Turn Relay ON</button>
  <button onclick="sendCommand('OFF')">Turn Relay OFF</button>
  <br><br>
  
  <!-- Motor slider -->
  <label>Motor %:</label>
  <input type="range" id="motorSlider" min="0" max="100" value="0" oninput="sendMotor(this.value)">
  <span id="motorValue">0%</span>

  <script>
    // Connect to HiveMQ WebSocket
    const client = new Paho.MQTT.Client("93bad3def29641e399de9a7b9c676613.s1.eu.hivemq.cloud", 8000, "webClient_" + Math.random());

    client.connect({
      userName: "tohits",
      password: "toh123@TOH",
      onSuccess: () => { console.log("Connected to MQTT!"); },
      onFailure: (err) => { console.log("Connection failed:", err); }
    });

    function sendCommand(command) {
      const message = new Paho.MQTT.Message(command);
      message.destinationName = "home/esp1/command";
      client.send(message);
    }

    function sendMotor(value) {
      document.getElementById("motorValue").innerText = value + "%";
      const message = new Paho.MQTT.Message("MOTOR:" + value);
      message.destinationName = "home/esp1/command";
      client.send(message);
    }
  </script>
</body>
</html>
