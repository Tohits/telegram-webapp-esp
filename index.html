<!DOCTYPE html>
<html>
<head>
  <title>MQTT Motor Control</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
</head>
<body>
  <h2>Motor Control Panel</h2>
  <button onclick="sendCommand('forward')">Forward</button>
  <button onclick="sendCommand('backward')">Backward</button>
  <button onclick="sendCommand('stop')">Stop</button>
  <p id="status">Connecting to MQTT...</p>

  <script>
    const broker = "broker.hivemq.com";
    const port = 8000; // WebSocket port for browser
    const topic = "tohid/motor";

    let client = new Paho.MQTT.Client(broker, port, "webClient-" + Math.random());

    client.onConnectionLost = () => {
      document.getElementById("status").innerText = "Connection lost";
    };

    client.onMessageArrived = (message) => {
      document.getElementById("status").innerText = "Received: " + message.payloadString;
    };

    client.connect({
      onSuccess: () => {
        document.getElementById("status").innerText = "Connected to MQTT";
      }
    });

    function sendCommand(cmd) {
      let message = new Paho.MQTT.Message(cmd);
      message.destinationName = topic;
      client.send(message);
      document.getElementById("status").innerText = "Sent: " + cmd;
    }
  </script>
</body>
</html>
