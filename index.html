<!DOCTYPE html>
<html>
<head>
  <title>MQTT Motor Control</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
  <h2>MQTT Motor Control</h2>
  <button onclick="sendCommand('forward')">Forward</button>
  <button onclick="sendCommand('backward')">Backward</button>
  <button onclick="sendCommand('stop')">Stop</button>
  <br><br>
  <input type="range" min="0" max="1023" value="0" id="slider" oninput="sendSlider(this.value)">
  <p>Speed: <span id="speedVal">0</span></p>

  <script>
    // HiveMQ Cloud broker (WebSocket)
    const options = {
      username: "tohits",  // your HiveMQ username
      password: "toh123@TOH",  // your HiveMQ password
      clean: true,
      connectTimeout: 4000,
      reconnectPeriod: 5000,
    };

    const client = mqtt.connect("wss://93bad3def29641e399de9a7b9c676613.s1.eu.hivemq.cloud:8884/mqtt", options);

    client.on("connect", () => {
      console.log("Connected to MQTT broker");
    });

    client.on("error", (err) => {
      console.error("Connection failed:", err);
    });

    function sendCommand(cmd) {
      client.publish("motor/cmd", cmd);
    }

    function sendSlider(val) {
      document.getElementById("speedVal").innerText = val;
      client.publish("motor/slider", val);
    }
  </script>
</body>
</html>
